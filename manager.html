<html>

<head>
    <script>
        window.mxBasePath = '/proceduremanager/mxGraph';
    </script>
    <script src="/proceduremanager/mxGraph/mxClient.js"></script>
    <script src="/proceduremanager/proceduremanager.js"></script>
    <script src="/procedureplayer/procedureplayer.js"></script>
    <script>
        function Q(selector, ctx) {
            let results = [];

            if (selector.nodeType) results.push(selector);
            else if (selector instanceof Array) results = selector;
            else {
                if (!ctx) ctx = window.document;
                else if (typeof ctx === 'string') ctx = window.document.querySelector(ctx);
                results = [].slice.call(ctx.querySelectorAll(selector));
            }

            return results.length === 1 ? results[0] : results;
        }

        function isEmpty(obj) {
            if (!obj) return true;
            if (obj instanceof Array || typeof obj.length != 'undefined') return !obj.length;
        }

        function createElement(html) {
            if (!html.startsWith('<')) return document.createElement(html);
            let div = document.createElement('div');
            div.innerHTML = html.trim();
            return div.firstChild; //Change this to div.childNodes to support multiple top-level nodes
        }

        function createPopup() {
            var popup = createElement('<div class="popup"></div>');
            var close = createElement('<span class="close">+</span>');
            close.onclick = () => popup.parentNode.removeChild(popup);
            popup.appendChild(close);
            return popup;
        }
    </script>
    <link rel="stylesheet" type="text/css" href="/manager.css">
</head>

<body>
    <div style="display:flex;height: 100%;">
         <div style="flex:4;border:2px solid #78909c;overflow: scroll;">
            <div id="graphContainer" tabindex="0"></div>
        </div>

        <div style="position:absolute;left: 20px;bottom:80px;">
            <span id="newStart" style="display:inline-block;cursor:move;background:#fff;border-radius: 70px;border: 2px solid #66cc00;width: 40px;box-shadow: 3px 3px #e6e6e6;height: 40px;"></span>
            <span id="newNode" style="margin-left:10px;display:inline-block;cursor:move;background:#fff;border-radius: 8px;border: 1px solid black;width: 40px;box-shadow: 3px 3px #e6e6e6;height: 40px;"></span>
            <span id="newGroup" style="margin-left:10px;display:inline-block;cursor:move;background:#fff;border: 2px dotted #777777;width: 40px;box-shadow: 3px 3px #e6e6e6;height: 40px;"></span>
            <span id="newEnd" style="margin-left:10px;display:inline-block;cursor:move;background:#fff;border-radius: 70px;border: 2px solid #ff6666;width: 40px;box-shadow: 3px 3px #e6e6e6;height: 40px;"></span>
        </div>

        <div style="position:absolute;left:20px;bottom:35px;">
            <button id="autoSize">Autosize</button>
            <button id="horizontal" style="margin-left: 13px;">⇉</button>
            <button id="vertical">⇊</button>
            <button id="organic">↺</button>
            <button id="zoomOut" style="margin-left: 13px;">-</button>
            <button id="zoomIn">+</button>
            <button id="zoomFit">Fit</button>
            <button id="zoomReset">100%</button>
            <button id="delete" style="margin-left: 13px;">Delete</button>
            <button id="xml" style="margin-left: 13px;">Xml</button>
            <button id="json">Json</button>
            <button id="export" style="margin-left: 13px;">Image</button>
            <button id="play">Play</button>
        </div>

        <div style="background:#f1f1f1;flex:1;border:2px solid #78909c;border-left:0;padding:10px;display:flex;flex-direction:column;">
            <div class="form-row" id="procTitle">
                <label>Procedure title</label>
                <textarea rows="3"></textarea>
            </div>

            <div class="form-row" id="procDesc" style="flex:1">
                <label>Procedure description</label>
                <div contenteditable></div>
            </div>

            <div class="form-row" id="itemTitle" style="display:none;">
                <label>Item title</label>
                <textarea rows="3"></textarea>
            </div>

            <div class="form-row" id="itemDesc" style="display:none;">
                <label>Item description</label>
                <div contenteditable></div>
            </div>
        </div>
    </div>
</body>

</html>